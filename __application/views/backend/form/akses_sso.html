<form id="form_{$acak}" method="post" url="{$host}backoffice-simpan/akses_sso" enctype="multipart/form-data" >
    <input type="hidden" name="id" value="{$data.id|default:''}" />
    <input type="hidden" name="editstatus" value="{$sts|default:'add'}" />
    
    <div class="row">
		<div class="col-md-4">
			{include file="backend/template/input_form.html" required="true" label="Username" class_width="col-lg-12"  type="text" name="username" id="username" value={$data.username|default:""} }
        </div>
        <div class="col-md-4">
            {include file="backend/template/input_form.html" required="true" label="Password" class_width="col-lg-12" type="pwd" name="password" id="password" value="{$data.password|default:''}"}
        </div>
        <div class="col-md-4">
			{include file="backend/template/input_form.html" required="true" label="Nama Lengkap" class_width="col-lg-12"  type="text" name="nama_lengkap" id="nama_lengkap" value={$data.nama_lengkap|default:""} }
        </div>
        <div class="col-md-6">
			{include file="backend/template/input_form.html" required="true" label="Departemen" class_width="col-lg-12"  type="text" name="departemen" id="departemen" value={$data.departemen|default:""} }
        </div>
        <div class="col-md-6">
			{include file="backend/template/input_form.html" required="true" label="Posisi" class_width="col-lg-12"  type="text" name="posisi" id="posisi" value={$data.posisi|default:""} }
        </div>
    </div>
    <hr/>
    <div class="row">
        <div class='col-md-6'>
            <label>List Aplikasi Terintegrasi SSO</label>
            <table id="tabel_app" class="table table-bordered table-striped table-hover">
                <thead>
                    <tr style='background-color:#3C8DBC;color:#fff;'>
                        <th class='text-center' style='vertical-align:middle;' width='10%'>#</th>
                        <th class='text-center' style='vertical-align:middle;' width='50%'>Aplikasi</th>
                        <th class='text-center' style='vertical-align:middle;' width='40%'>Grup User</th>
                    </tr>
                </thead>
                <tbody class="po">
                    {foreach from=$aplikasi item=rows}
                        <tr>
                            <td class='text-center'>
                                {if $rows.role|default neq ''}
                                    {assign var=checked value="checked"}
                                {else}
                                    {assign var=checked value=""}
                                {/if}

                                <input {$checked} type="checkbox" name="tbl_aplikasi_id[]" value="{$rows.id|default:''}" />
                            </td>
                            <td>{$rows.nama|default:''}</td>
                            <td>
                                <select class="form-control" name="tbl_aplikasi_grup_id[{$rows.id|default:''}]">
                                    {foreach from=$rows.grup item=riws}
                                        {if $riws.id|default eq $rows.role}
                                            {assign var=selected value="selected"}
                                        {else}
                                            {assign var=selected value=""}
                                        {/if}

                                        <option {$selected} value="{$riws.id|default:''}">{$riws.nama_grup|default:''}</option>
                                    {/foreach}
                                </select>
                            </td>
                        </tr>
                    {/foreach}
                </tbody>

            </table>
        </div>
    </div>

	<div class="row">
		<div class="col-md-12">
            <hr />
			{include file="backend/template/button_save.html" text="Simpan" id_na="save" style_btn="btn-success"  btn_goyz="false"}
			{include file="backend/template/button_save.html" text="Kembali" click="$('#grid_nya_{$mod}').show();$('#detil_nya_{$mod}').hide();" id_na="cancel" style_btn="btn-danger"  btn_goyz="true"}	
		</div>
	</div>
</form>

<script>
    var rulesnya = {
		username : "required",
		password : "required",
		departemen : "required",
		posisi : "required",
	};

	var messagesnya = {
		username : "<i style='color:red'>Harus Diisi</i>",
		password : "<i style='color:red'>Harus Diisi</i>",
		departemen : "<i style='color:red'>Harus Diisi</i>",
		posisi : "<i style='color:red'>Harus Diisi</i>",
	}

	$( "#form_{$acak}" ).validate( {
		rules: rulesnya,
		messages: messagesnya,
		submitHandler: function(form) {
			$.LoadingOverlay("show");
			submit_form('form_{$acak}',function(r){
				if(r == 1 ){ 
					$.messager.alert(nama_apps,'Data Tersimpan','info'); 
					$('#cancel_{$acak}').trigger('click');
					$('#grid_{$mod}').datagrid('reload');
				}else{ 
					$.messager.alert(nama_apps,'Proses Simpan Data Gagal '+r,'warning'); 
				}
				$.LoadingOverlay("hide", true);
			});
			//*/
		},
		errorPlacement: function(error, element) {
	        var name = element.attr('name');
	        var errorSelector = '.validation_error_message[for="' + name + '"]';
	        var $element = $(errorSelector);
	        if ($element.length) { 
	            $(errorSelector).html(error.html());
	        } else {
	            error.insertAfter(element);
	        }
	    }
	} );
</script>